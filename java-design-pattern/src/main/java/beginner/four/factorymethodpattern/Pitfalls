Complexity

Not easy to refactor
